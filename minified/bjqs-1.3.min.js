(function(a){a.fn.bjqs=function(v){var l={width:960,height:300,animtype:"fade",animduration:450,animspeed:4000,automatic:true,showcontrols:true,centercontrols:true,nexttext:"Next",prevtext:"Prev",showmarkers:true,centermarkers:true,keyboardnav:true,hoverpause:true,usecaptions:true,randomstart:false,responsive:false};var F=a.extend({},l,v);var A=this,E=A.find("ul.bjqs"),D=E.children("li"),y=a("#container"),q=null,u=null,m=null,G=null,j=null,i=null,n=null,B=null;var h={slidecount:D.length,animating:false,paused:false,currentslide:1,nextslide:0,currentindex:0,nextindex:0,interval:null};var e={width:null,height:null,ratio:null};var s={fwd:"forward",prev:"previous"};var z=function(){D.addClass("bjqs-slide");if(F.responsive){b()}else{d()}if(h.slidecount>1){if(F.randomstart){g()}if(F.showcontrols){w()}if(F.showmarkers){c()}if(F.keyboardnav){r()}if(F.hoverpause&&F.automatic){p()}if(F.animtype==="slide"){C()}}else{F.automatic=false}if(F.usecaptions){f()}if(F.animtype==="slide"&&!F.randomstart){h.currentindex=1;h.currentslide=2}E.show();D.eq(h.currentindex).show();if(F.automatic){h.interval=setInterval(function(){x(s.fwd,false)},F.animspeed)}};var b=function(){e.width=A.outerWidth();e.ratio=e.width/F.width,e.height=F.height*e.ratio;if(F.animtype==="fade"){D.css({height:F.height,width:"100%"});D.children("img").css({height:F.height,width:"100%"});E.css({height:F.height,width:"100%"});A.css({height:F.height,"max-width":F.width,position:"relative"});if(e.width<F.width){D.css({height:e.height});D.children("img").css({height:e.height});E.css({height:e.height});A.css({height:e.height})}a(window).resize(function(){e.width=A.outerWidth();e.ratio=e.width/F.width,e.height=F.height*e.ratio;D.css({height:e.height});D.children("img").css({height:e.height});E.css({height:e.height});A.css({height:e.height})})}if(F.animtype==="slide"){D.css({height:F.height,width:F.width});D.children("img").css({height:F.height,width:F.width});E.css({height:F.height,width:F.width*F.slidecount});A.css({height:F.height,"max-width":F.width,position:"relative"});if(e.width<F.width){D.css({height:e.height});D.children("img").css({height:e.height});E.css({height:e.height});A.css({height:e.height})}a(window).resize(function(){e.width=A.outerWidth(),e.ratio=e.width/F.width,e.height=F.height*e.ratio;D.css({height:e.height,width:e.width});D.children("img").css({height:e.height,width:e.width});E.css({height:e.height,width:e.width*F.slidecount});A.css({height:e.height});i.css({height:e.height,width:e.width});t(function(){x(false,h.currentslide)},200,"some unique string")})}};var t=(function(){var o={};return function(J,H,I){if(!I){I="Don't call this twice without a uniqueId"}if(o[I]){clearTimeout(o[I])}o[I]=setTimeout(J,H)}})();var d=function(){D.css({height:F.height,width:F.width});E.css({height:F.height,width:F.width});A.css({height:F.height,width:F.width,position:"relative"})};var C=function(){n=D.eq(0).clone();B=D.eq(h.slidecount-1).clone();n.attr({"data-clone":"last","data-slide":0}).appendTo(E).show();B.attr({"data-clone":"first","data-slide":0}).prependTo(E).show();D=E.children("li");h.slidecount=D.length;i=a('<div class="bjqs-wrapper"></div>');if(F.responsive&&(e.width<F.width)){i.css({width:e.width,height:e.height,overflow:"hidden",position:"relative"});E.css({width:e.width*(h.slidecount+2),left:-e.width*h.currentslide})}else{i.css({width:F.width,height:F.height,overflow:"hidden",position:"relative"});E.css({width:F.width*(h.slidecount+2),left:-F.width*h.currentslide})}D.css({"float":"left",position:"relative",display:"list-item"});i.prependTo(A);E.appendTo(i)};var w=function(){q=a('<ul class="bjqs-controls"></ul>');u=a('<li class="bjqs-next"><a href="#" data-direction="'+s.fwd+'">'+F.nexttext+"</a></li>");m=a('<li class="bjqs-prev"><a href="#" data-direction="'+s.prev+'">'+F.prevtext+"</a></li>");q.on("click","a",function(K){K.preventDefault();var J=a(this).attr("data-direction");if(!h.animating){if(J===s.fwd){x(s.fwd,false)}if(J===s.prev){x(s.prev,false)}}});m.appendTo(q);u.appendTo(q);q.appendTo(y);if(F.centercontrols){q.addClass("v-centered");var I=(y.height()-u.children("a").outerHeight())/2,o=(I/F.height)*100,H=o+"%";u.find("a").css("top",H);m.find("a").css("top",H)}else{q.addClass("v-top");var H=0+"%";u.find("a").css("top",H);m.find("a").css("top",H)}};var c=function(){G=a('<ol class="bjqs-markers"></ol>');a.each(D,function(J,H){var L=J+1,K=J+1;if(F.animtype==="slide"){K=J+2}var I=a('<li><a href="#">'+L+"</a></li>");if(L===h.currentslide){I.addClass("active-marker")}I.on("click","a",function(M){M.preventDefault();if(!h.animating&&h.currentslide!==K){x(false,K)}});I.appendTo(G)});G.appendTo(A);j=G.find("li");if(F.centermarkers){G.addClass("h-centered");var o=(F.width-G.width())/2;G.css("left",o)}};var r=function(){a(document).keyup(function(o){if(!h.paused){clearInterval(h.interval);h.paused=true}if(!h.animating){if(o.keyCode===39){o.preventDefault();x(s.fwd,false)}else{if(o.keyCode===37){o.preventDefault();x(s.prev,false)}}}if(h.paused&&F.automatic){h.interval=setInterval(function(){x(s.fwd)},F.animspeed);h.paused=false}})};var p=function(){A.hover(function(){if(!h.paused){clearInterval(h.interval);h.paused=true}},function(){if(h.paused){h.interval=setInterval(function(){x(s.fwd,false)},F.animspeed);h.paused=false}})};var f=function(){a.each(D,function(I,o){var H=a(o).children("img:first-child").attr("title");if(!H){H=a(o).children("a").find("img:first-child").attr("title")}if(H){H=a('<p class="bjqs-caption">'+H+"</p>");H.appendTo(a(o))}})};var g=function(){var o=Math.floor(Math.random()*h.slidecount)+1;h.currentslide=o;h.currentindex=o-1};var k=function(o){if(o===s.fwd){if(D.eq(h.currentindex).next().length){h.nextindex=h.currentindex+1;h.nextslide=h.currentslide+1}else{h.nextindex=0;h.nextslide=1}}else{if(D.eq(h.currentindex).prev().length){h.nextindex=h.currentindex-1;h.nextslide=h.currentslide-1}else{h.nextindex=h.slidecount-1;h.nextslide=h.slidecount}}};var x=function(I,o){if(!h.animating){h.animating=true;if(o){h.nextslide=o;h.nextindex=o-1}else{k(I)}if(F.animtype==="fade"){if(F.showmarkers){j.removeClass("active-marker");j.eq(h.nextindex).addClass("active-marker")}D.eq(h.currentindex).fadeOut(F.animduration);D.eq(h.nextindex).fadeIn(F.animduration,function(){h.animating=false;h.currentslide=h.nextslide;h.currentindex=h.nextindex})}if(F.animtype==="slide"){if(F.showmarkers){var H=h.nextindex-1;if(H===h.slidecount-2){H=0}else{if(H===-1){H=h.slidecount-3}}j.removeClass("active-marker");j.eq(H).addClass("active-marker")}if(F.responsive&&(e.width<F.width)){h.slidewidth=e.width}else{h.slidewidth=F.width}E.animate({left:-h.nextindex*h.slidewidth},F.animduration,function(){h.currentslide=h.nextslide;h.currentindex=h.nextindex;if(D.eq(h.currentindex).attr("data-clone")==="last"){E.css({left:-h.slidewidth});h.currentslide=2;h.currentindex=1}else{if(D.eq(h.currentindex).attr("data-clone")==="first"){E.css({left:-h.slidewidth*(h.slidecount-2)});h.currentslide=h.slidecount-1;h.currentindex=h.slidecount-2}}h.animating=false})}}};z()}})(jQuery);